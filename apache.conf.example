# Apache configuration for Check4Fail status page
# Place this in /etc/apache2/sites-available/status.example.com.conf
# Enable: a2ensite status.example.com
# Reload: apache2ctl configtest && systemctl reload apache2

<VirtualHost *:80>
    ServerName status.example.com
    ServerAdmin admin@example.com
    
    DocumentRoot /path/to/check4fail/public_html
    
    <Directory /path/to/check4fail/public_html>
        Options -Indexes +FollowSymLinks
        AllowOverride None
        Require all granted
        
        # Default file
        DirectoryIndex index.html
    </Directory>
    
    # Security headers
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-XSS-Protection "1; mode=block"
    
    # Prevent caching of HTML status pages (fixes Chrome auto-refresh issues)
    <FilesMatch "\.html$">
        Header set Cache-Control "no-cache, no-store, must-revalidate"
        Header set Pragma "no-cache"
        Header set Expires "0"
    </FilesMatch>
    
    # Cache static assets
    <FilesMatch "\.(css|js|jpg|jpeg|png|gif|ico|svg)$">
        Header set Cache-Control "public, max-age=3600"
    </FilesMatch>
    
    # Deny access to hidden files
    <FilesMatch "^\.">
        Require all denied
    </FilesMatch>
    
    ErrorLog ${APACHE_LOG_DIR}/status.example.com.error.log
    CustomLog ${APACHE_LOG_DIR}/status.example.com.access.log combined
</VirtualHost>

# HTTPS configuration (optional, requires SSL certificate)
# <VirtualHost *:443>
#     ServerName status.example.com
#     ServerAdmin admin@example.com
#     
#     DocumentRoot /path/to/check4fail/public_html
#     
#     SSLEngine on
#     SSLCertificateFile /etc/letsencrypt/live/status.example.com/fullchain.pem
#     SSLCertificateKeyFile /etc/letsencrypt/live/status.example.com/privkey.pem
#     
#     # Same configuration as above
# </VirtualHost>
